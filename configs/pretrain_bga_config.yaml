# Configuration for Pre-training on Synthetic BGA Data

data:
  # Path to the synthetic data generated by generate_bga_synthetic_data.py
  path: "data/bga_synthetic"

  # Data structure layout
  layout:
    num_wavelengths: 4
    num_buckets: 3
    file_pattern: "w{w_idx}_b{b_idx}.png" # 0-indexed file naming rule

  normalization: "minmax"
  roi: null
  num_workers: 4

model:
  name: "PIKANs"
  # Input: 4 wavelengths * 3 buckets = 12 channels
  kan_layers: [12, 64, 64, 1]
  grid_size: 5
  spline_order: 3
  # Wavelengths must match those in the data generation script
  wavelengths: [633.0, 532.0, 450.0, 780.0] # Wavelengths in nm

training:
  epochs: 50
  batch_size: 4096
  learning_rate: 0.001
  optimizer: "Adam"
  scheduler:
    type: "StepLR"
    step_size: 20
    gamma: 0.1
  # For pre-training, we use both MSE (with GT) and Physics loss
  loss_weights:
    mse: 1.0
    physics: 0.1

output:
  log_dir: "outputs/logs"
  model_dir: "outputs/models"
